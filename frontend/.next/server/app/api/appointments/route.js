(()=>{var e={};e.id=712,e.ids=[712],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},1997:e=>{"use strict";e.exports=require("punycode")},2278:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>A,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>c,POST:()=>p});var i=r(6559),n=r(8088),s=r(7719),o=r(2190),l=r(4099);async function c(){try{let e=await l.mG.getAll();return o.NextResponse.json(e)}catch(e){return console.error("Error fetching appointments:",e),o.NextResponse.json({error:"Failed to fetch appointments"},{status:500})}}async function p(e){try{let t=await e.json(),r=await l.mG.create(t);return o.NextResponse.json(r,{status:201})}catch(e){return console.error("Error creating appointment:",e),o.NextResponse.json({error:"Failed to create appointment"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/appointments/route",pathname:"/api/appointments",filename:"route",bundlePath:"app/api/appointments/route"},resolvedPagePath:"/app/frontend/src/app/api/appointments/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:u,workUnitAsyncStorage:m,serverHooks:g}=d;function A(){return(0,s.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:m})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4075:e=>{"use strict";e.exports=require("zlib")},4099:(e,t,r)=>{"use strict";r.d(t,{Ar:()=>d,IY:()=>g,mG:()=>u,yq:()=>m});var a=r(4406),i=r.n(a);console.log("Environment check:",{hasApiKey:!!process.env.AIRTABLE_API_KEY,hasBaseId:!!process.env.AIRTABLE_BASE_ID,apiKeyLength:process.env.AIRTABLE_API_KEY?.length,baseIdLength:process.env.AIRTABLE_BASE_ID?.length});let n=process.env.AIRTABLE_API_KEY,s=process.env.AIRTABLE_BASE_ID;n||console.warn("AIRTABLE_API_KEY not found in environment variables"),s||console.warn("AIRTABLE_BASE_ID not found in environment variables");let o=null,l=null;if(n&&s)try{l=new(i())({apiKey:n}).base(s),console.log("Airtable initialized successfully")}catch(e){console.error("Failed to initialize Airtable:",e)}else console.error("Missing Airtable credentials:",{apiKey:!!n,baseId:!!s});let c={CLIENTS:"Table 1",APPOINTMENTS:"Appointments",SERVICES:"Services",AVAILABILITY:"Availability"},p=()=>{let e=null!==l&&n&&s;return console.log("isConfigured check:",{configured:e,hasBase:!!l,hasApiKey:!!n,hasBaseId:!!s}),e},d={async getAll(){if(console.log("clientOperations.getAll called"),!p())return console.error("Airtable not configured - returning mock data"),[{id:"mock1",name:"Sarah Johnson",email:"sarah@example.com",phone:"+1 (555) 123-4567",lastVisit:"2024-01-15",preferredService:"Hair Cut & Color",totalVisits:12,totalSpent:1450,tags:["VIP","Regular"],notes:"Prefers Jessica as stylist",createdAt:new Date().toISOString()},{id:"mock2",name:"Mike Chen",email:"mike@example.com",phone:"+1 (555) 987-6543",lastVisit:"2024-01-10",preferredService:"Beard Trim",totalVisits:8,totalSpent:320,tags:["Regular"],notes:"Usually books on weekends",createdAt:new Date().toISOString()}];try{let e=await l(c.CLIENTS).select({maxRecords:1}).all();return e.length>0&&console.log("Available fields:",Object.keys(e[0].fields)),(await l(c.CLIENTS).select().all()).map(e=>{let t=e.fields;return console.log("Record fields:",Object.keys(t)),{id:e.id,name:t.Name||t["Client Name"]||t.name||"Unknown",email:t.Email||t.email||"",phone:t.Phone||t.phone||"",lastVisit:t["Last Visit"]||t.lastVisit||"",nextAppointment:t["Next Appointment"]||t.nextAppointment||"",preferredService:t["Preferred Service"]||t.preferredService||"",totalVisits:t["Total Visits"]||t.totalVisits||0,totalSpent:t["Total Spent"]||t.totalSpent||0,tags:t.Tags||t.tags||[],notes:t.Notes||t.notes||"",createdAt:t["Created At"]||t.createdAt||new Date().toISOString()}})}catch(e){return console.error("Error fetching clients:",e),[{id:"mock1",name:"Sarah Johnson",email:"sarah@example.com",phone:"+1 (555) 123-4567",lastVisit:"2024-01-15",preferredService:"Hair Cut & Color",totalVisits:12,totalSpent:1450,tags:["VIP","Regular"],notes:"Prefers Jessica as stylist",createdAt:new Date().toISOString()}]}},async create(e){if(!p())throw console.error("Airtable not configured - cannot create client"),Error("Airtable not configured. Please check your API key and Base ID.");try{let t=await l(c.CLIENTS).create({Name:e.name,Email:e.email,Phone:e.phone,"Preferred Service":e.preferredService,"Total Visits":e.totalVisits,"Total Spent":e.totalSpent,Tags:e.tags,Notes:e.notes});return{id:t.id,...e,createdAt:t.get("Created At")}}catch(e){throw console.error("Error creating client:",e),e}},async update(e,t){if(!p())throw Error("Airtable not configured. Please check your API key and Base ID.");try{let r=await l(c.CLIENTS).update(e,{...t.name&&{Name:t.name},...t.email&&{Email:t.email},...t.phone&&{Phone:t.phone},...t.lastVisit&&{"Last Visit":t.lastVisit},...t.nextAppointment&&{"Next Appointment":t.nextAppointment},...t.preferredService&&{"Preferred Service":t.preferredService},...void 0!==t.totalVisits&&{"Total Visits":t.totalVisits},...void 0!==t.totalSpent&&{"Total Spent":t.totalSpent},...t.tags&&{Tags:t.tags},...t.notes&&{Notes:t.notes}});return{id:r.id,name:r.get("Name"),email:r.get("Email"),phone:r.get("Phone"),lastVisit:r.get("Last Visit"),nextAppointment:r.get("Next Appointment"),preferredService:r.get("Preferred Service"),totalVisits:r.get("Total Visits"),totalSpent:r.get("Total Spent"),tags:r.get("Tags"),notes:r.get("Notes"),createdAt:r.get("Created At")}}catch(e){throw console.error("Error updating client:",e),e}}},u={async getAll(){if(!p())return[];try{return(await l(c.APPOINTMENTS).select({sort:[{field:"Date",direction:"desc"}]}).all()).map(e=>({id:e.id,clientId:e.get("Client ID"),clientName:e.get("Client Name"),service:e.get("Service"),staff:e.get("Staff"),date:e.get("Date"),time:e.get("Time"),duration:e.get("Duration"),status:e.get("Status"),price:e.get("Price"),notes:e.get("Notes")}))}catch(e){return console.error("Error fetching appointments:",e),[]}},async create(e){if(!p())throw Error("Airtable not configured. Please check your API key and Base ID.");try{return{id:(await l(c.APPOINTMENTS).create({"Client ID":e.clientId,"Client Name":e.clientName,Service:e.service,Staff:e.staff,Date:e.date,Time:e.time,Duration:e.duration,Status:e.status,Price:e.price,Notes:e.notes})).id,...e}}catch(e){throw console.error("Error creating appointment:",e),e}}},m={async getByDate(e){if(!p())return[];try{return(await l(c.AVAILABILITY).select({filterByFormula:`{Date} = '${e}'`,sort:[{field:"Start Time",direction:"asc"}]}).all()).map(e=>({id:e.id,staff:e.get("Staff"),date:e.get("Date"),startTime:e.get("Start Time"),endTime:e.get("End Time"),isAvailable:e.get("Is Available"),appointmentId:e.get("Appointment ID")}))}catch(e){return console.error("Error fetching availability:",e),[]}},async update(e,t){if(!p())throw Error("Airtable not configured. Please check your API key and Base ID.");try{let r=await l(c.AVAILABILITY).update(e,{...t.staff&&{Staff:t.staff},...void 0!==t.isAvailable&&{"Is Available":t.isAvailable},...t.appointmentId&&{"Appointment ID":t.appointmentId}});return{id:r.id,staff:r.get("Staff"),date:r.get("Date"),startTime:r.get("Start Time"),endTime:r.get("End Time"),isAvailable:r.get("Is Available"),appointmentId:r.get("Appointment ID")}}catch(e){throw console.error("Error updating availability:",e),e}}},g={async getAll(){if(!p())return[];try{return(await l(c.SERVICES).select({sort:[{field:"Name",direction:"asc"}]}).all()).map(e=>({id:e.id,name:e.get("Name"),duration:e.get("Duration"),price:e.get("Price"),description:e.get("Description"),category:e.get("Category")}))}catch(e){return console.error("Error fetching services:",e),[]}}}},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5591:e=>{"use strict";e.exports=require("https")},6487:()=>{},7910:e=>{"use strict";e.exports=require("stream")},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,580,406],()=>r(2278));module.exports=a})();