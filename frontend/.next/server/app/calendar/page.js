(()=>{var e={};e.id=85,e.ids=[85],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1490:(e,t,r)=>{Promise.resolve().then(r.bind(r,4491))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4491:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(687),n=r(3210),a=r(6474),l=r(2557);function i(){let[e,t]=(0,n.useState)([]),[r,i]=(0,n.useState)(!0),[o,d]=(0,n.useState)(null),[c,p]=(0,n.useState)(new Date),[u,x]=(0,n.useState)(!1),[m,h]=(0,n.useState)(!1),[g,b]=(0,n.useState)([]),[v,f]=(0,n.useState)([]),[j,y]=(0,n.useState)([]),[N,w]=(0,n.useState)({client_id:"",service_id:"",employee_id:"",date:"",time:"10:00 AM",notes:""}),M=async e=>{e.preventDefault();try{let e=await fetch("/api/appointments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!e.ok)throw Error("Failed to create appointment");let t=await e.json();console.log("✅ Appointment created:",t),w({client_id:"",service_id:"",employee_id:"",date:"",time:"10:00 AM",notes:""}),h(!1),await P()}catch(e){console.error("❌ Error creating appointment:",e),d(e instanceof Error?e.message:"Failed to create appointment")}},P=async()=>{try{i(!0);let e="/api/records";console.log("\uD83D\uDD0D Fetching via Next.js proxy:",e);let r=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log("\uD83D\uDD0D Response status:",r.status),!r.ok){let e=await r.text();throw console.error("❌ Response error:",e),Error(`HTTP ${r.status}: ${r.statusText}`)}let s=await r.json();console.log("\uD83D\uDD0D Total records via proxy:",s.length);let n=s.filter(e=>e.lastVisit);console.log("\uD83D\uDD0D Records with dates:",n.length);let a=n.filter(e=>e.lastVisit?.includes("2025-07"));console.log("\uD83D\uDD0D July appointments detail:"),a.forEach(e=>{console.log(`  - ${e.name||e.id.slice(-4)}: ${e.lastVisit}`)});let l=n.map(e=>{let t=e.lastVisit||"";if(t&&t.includes("2025-07")){let[r,s,n]=t.split("-"),a=new Date(parseInt(r),parseInt(s)-1,parseInt(n));a.setDate(a.getDate()-1);let l=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0");t=`${l}-${i}-${o}`,console.log(`📅 Date adjusted: ${e.lastVisit} → ${t} for ${e.name||e.id.slice(-4)}`)}return{id:e.id,title:e.preferredService||e.name||`Appointment ${e.id.slice(-4)}`,client:e.name||`Client ${e.id.slice(-4)}`,service:e.preferredService||"Service",date:t,status:e.tags?.[0]||"scheduled",color:A(e.tags?.[0]||"scheduled")}});console.log("\uD83D\uDD0D Transformed appointments:",l.length),console.log("\uD83D\uDD0D July transformed appointments:"),l.filter(e=>e.date.includes("2025-07")).forEach(e=>{console.log(`  - ${e.client}: ${e.date}`)}),t(l),d(null),console.log("✅ Successfully loaded appointments via proxy!")}catch(e){console.error("❌ Proxy connection failed:",e),d(`Connection failed via proxy: ${e instanceof Error?e.message:"Unknown error"}`)}finally{i(!1)}},A=e=>{switch(e.toLowerCase()){case"completed":return"bg-green-500";case"scheduled":return"bg-blue-500";case"cancelled":return"bg-red-500";default:return"bg-purple-500"}},S=t=>{let r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),a=`${r}-${s}-${n}`,l=e.filter(e=>e.date.split("T")[0]===a);return a.includes("2025-07")&&(console.log(`📅 ${a}: ${l.length} appointments`),l.length>0&&console.log(`   - Appointments: ${l.map(e=>e.client).join(", ")}`)),l};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-pink-50 flex",children:[(0,s.jsx)(l.A,{darkMode:u}),(0,s.jsx)("div",{className:"flex-1 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Calendar"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage your appointments from Airtable"})]}),(0,s.jsxs)("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700",children:[(0,s.jsx)(a.A,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Add Appointment"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-purple-100 p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("button",{onClick:()=>p(new Date(c.getFullYear(),c.getMonth()-1)),className:"p-2 hover:bg-gray-100 rounded-lg",children:"←"}),(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][c.getMonth()]," ",c.getFullYear()]}),(0,s.jsx)("button",{onClick:()=>p(new Date(c.getFullYear(),c.getMonth()+1)),className:"p-2 hover:bg-gray-100 rounded-lg",children:"→"})]}),r?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading appointments from Airtable..."})]}):o?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("p",{className:"text-red-600 mb-2",children:["Error: ",o]}),(0,s.jsx)("button",{onClick:P,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Retry"})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"grid grid-cols-7 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,s.jsx)("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-0 border border-gray-200 rounded-lg overflow-hidden",children:(e=>{let t=e.getFullYear(),r=e.getMonth(),s=new Date(t,r,1),n=new Date(t,r+1,0).getDate(),a=s.getDay(),l=[];for(let e=0;e<a;e++)l.push(null);for(let e=1;e<=n;e++)l.push(new Date(t,r,e));return l})(c).map((e,t)=>{let r=e?S(e):[],n=e&&e.toDateString()===new Date().toDateString();return(0,s.jsx)("div",{className:`min-h-32 p-2 border-r border-b border-gray-200 ${e?"hover:bg-gray-50 cursor-pointer":"bg-gray-50"} ${n?"bg-purple-50":""}`,children:e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:`text-sm font-medium mb-1 ${n?"text-purple-600 font-bold":"text-gray-900"}`,children:e.getDate()}),(0,s.jsxs)("div",{className:"space-y-1",children:[r.slice(0,3).map(e=>(0,s.jsx)("div",{className:`text-white text-xs p-1 rounded font-bold ${e.color}`,title:`${e.client} - ${e.service}`,children:e.client},e.id)),r.length>3&&(0,s.jsxs)("div",{className:"text-xs text-purple-600 font-bold",children:["+",r.length-3," more"]})]})]})},t)})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-purple-100 p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Appointment Statistics"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:e.length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Appointments"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.filter(e=>e.date.includes("2025-07")).length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"July Appointments"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"completed"===e.status.toLowerCase()).length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Completed"})]})]})]})]})}),m&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Appointment"}),(0,s.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),(0,s.jsxs)("select",{value:N.client_id,onChange:e=>w(t=>({...t,client_id:e.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select Client"}),g.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service *"}),(0,s.jsxs)("select",{value:N.service_id,onChange:e=>w(t=>({...t,service_id:e.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select Service"}),v.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Therapist *"}),(0,s.jsxs)("select",{value:N.employee_id,onChange:e=>w(t=>({...t,employee_id:e.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select Therapist"}),j.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Date *"}),(0,s.jsx)("input",{type:"date",value:N.date,onChange:e=>w(t=>({...t,date:e.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time"}),(0,s.jsxs)("select",{value:N.time,onChange:e=>w(t=>({...t,time:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"9:00 AM",children:"9:00 AM"}),(0,s.jsx)("option",{value:"9:30 AM",children:"9:30 AM"}),(0,s.jsx)("option",{value:"10:00 AM",children:"10:00 AM"}),(0,s.jsx)("option",{value:"10:30 AM",children:"10:30 AM"}),(0,s.jsx)("option",{value:"11:00 AM",children:"11:00 AM"}),(0,s.jsx)("option",{value:"11:30 AM",children:"11:30 AM"}),(0,s.jsx)("option",{value:"12:00 PM",children:"12:00 PM"}),(0,s.jsx)("option",{value:"12:30 PM",children:"12:30 PM"}),(0,s.jsx)("option",{value:"1:00 PM",children:"1:00 PM"}),(0,s.jsx)("option",{value:"1:30 PM",children:"1:30 PM"}),(0,s.jsx)("option",{value:"2:00 PM",children:"2:00 PM"}),(0,s.jsx)("option",{value:"2:30 PM",children:"2:30 PM"}),(0,s.jsx)("option",{value:"3:00 PM",children:"3:00 PM"}),(0,s.jsx)("option",{value:"3:30 PM",children:"3:30 PM"}),(0,s.jsx)("option",{value:"4:00 PM",children:"4:00 PM"}),(0,s.jsx)("option",{value:"4:30 PM",children:"4:30 PM"}),(0,s.jsx)("option",{value:"5:00 PM",children:"5:00 PM"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,s.jsx)("textarea",{value:N.notes,onChange:e=>w(t=>({...t,notes:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Additional notes for the appointment..."})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{h(!1),w({client_id:"",service_id:"",employee_id:"",date:"",time:"10:00 AM",notes:""})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-lg hover:bg-purple-700",children:"Create Appointment"})]})]})]})})})]})}},4728:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(5239),n=r(8088),a=r(8170),l=r.n(a),i=r(893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d={children:["",{children:["calendar",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9741)),"/app/frontend/src/app/calendar/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/app/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/app/frontend/src/app/calendar/page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/calendar/page",pathname:"/calendar",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6474:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(2688).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8442:(e,t,r)=>{Promise.resolve().then(r.bind(r,9741))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")},9741:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/app/frontend/src/app/calendar/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/app/frontend/src/app/calendar/page.tsx","default")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,496,433,908],()=>r(4728));module.exports=s})();